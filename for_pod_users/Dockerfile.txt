# Use an official PyTorch base image with CUDA support
FROM pytorch/pytorch:latest AS base

# Install additional dependencies for development
RUN apt-get update && apt-get install -y \
    python3 \
    python3-pip \
    && rm -rf /var/lib/apt/lists/*

# Install JupyterLab and VS Code Server
RUN pip install jupyterlab
RUN curl -fsSL https://code-server.dev/install.sh | sh

# Set up a working directory for the project
WORKDIR /app

# Copy the project files into the container
COPY . /app

# Expose ports for JupyterLab and VS Code Server
EXPOSE 8888 8080

# Start JupyterLab and VS Code Server when the container starts
CMD ["jupyter", "lab", "--ip=0.0.0.0", "--port=8888", "--no-browser", "--allow-root"]
CMD ["code-server", "--port=8080", "--auth=none", "--disable-telemetry", "--no-auth"]
